import{d as xe,r as f,f as Y,w as Z,j as ye,c as b,o as c,x as a,z as y,B as ee,A as t,a as e,E as o,y as l,t as i,n as te,C as A,J as X,F as R,v as K,H as F,D as Re,K as Fe}from"./index-BJF5uCCG.js";import{_ as Te,a as Ie}from"./AdminLayout-IN7vhrvB.js";import{i as ae,_ as se,a as le,b as z,c as g,d as re,e as p,P as we,f as ke,g as be,h as _e,k as he,l as Ce,j as Ue}from"./DeleteConfirmDialog-C2AAtoLY.js";import{a as C,f as q,_ as oe}from"./chevron-right-DPKj4TWY.js";import{l as Ee,p as Ne,a as He,t as Ae,_ as Ke}from"./home-DYAeRqdI.js";import{_ as $e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as Oe}from"./index-DwLEtfjI.js";const Je={class:"space-y-6"},Xe={class:"flex items-center justify-between mb-4"},qe={class:"inline-flex items-center text-emerald-600 dark:text-emerald-400 font-medium"},Ge={class:"inline-flex items-center text-red-600 dark:text-red-400 font-medium"},Qe={class:"mb-4"},We={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4 dark:bg-gray-800 dark:border-gray-700"},Ye={class:"flex items-center justify-between"},Ze={class:"flex items-center gap-4"},et={class:"flex items-center gap-2"},tt={class:"flex items-center gap-6"},at={class:"flex items-center gap-4"},st={class:"text-sm text-emerald-600 dark:text-emerald-400 font-medium"},lt={class:"text-sm text-red-600 dark:text-red-400 font-medium"},rt={class:"mt-4"},ot={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 dark:bg-gray-800"},nt={class:"p-6"},it={class:"text-center"},dt={class:"flex justify-center gap-3"},ut=xe({__name:"TaskDetail",props:{taskDetail:{}},emits:["close"],setup(O){const T=O,$=f(""),x=f(1),I=f(10),V=f(0),_=f(!1),L=f(!1),w=f([]),S=Y(()=>{const u=w.value.filter(d=>d.status==="success").length,s=w.value.filter(d=>d.status==="failed").length;return{success:u,failed:s}}),B=()=>{x.value=1,D()},P=()=>{console.log("重试按钮被点击"),console.log("失败数量:",S.value.failed),console.log("当前showRetryConfirm:",_.value),_.value=!0,console.log("设置后showRetryConfirm:",_.value)},D=async()=>{var u,s;L.value=!0;try{if(!((u=T.taskDetail)!=null&&u.id)){w.value=[],V.value=0;return}const d={simpletask_id:T.taskDetail.id,currentPage:x.value,pageSize:I.value};$.value&&$.value!=="all"&&(d.status=$.value);const h=await Ee(d);if(h&&h.results){const j=h.results||[];w.value=j.map(M=>({id:M.id||"",account:M.account||"",publish_time:M.created_at||"",status:M.success==="success"?"success":"failed",external_id:M.external_id||"",error_message:M.error_message||""})),V.value=((s=h.pagination)==null?void 0:s.total)||0}else w.value=[],V.value=0}catch(d){console.error("获取执行日志失败:",d),F.error("获取执行日志失败"),w.value=[],V.value=0}finally{L.value=!1}},U=async()=>{var u;try{_.value=!1;const s={simpletask_id:(u=T.taskDetail)==null?void 0:u.id};let d=await Ne(s);d.message?F.success(d.message):F.success("已开始重新执行失败的任务"),await D()}catch(s){console.error("重新执行失败:",s),F.error("重新执行失败")}};return Z(x,()=>{D()}),Z(()=>T.taskDetail,u=>{u!=null&&u.id&&D()},{deep:!0}),ye(()=>{D()}),(u,s)=>(c(),b("div",Je,[a(ae,null,{default:t(()=>[e("div",Xe,[s[7]||(s[7]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"任务参数",-1)),a(C,{variant:"outline",onClick:s[0]||(s[0]=d=>u.$emit("close"))},{default:t(()=>[...s[6]||(s[6]=[o(" 返回 ",-1)])]),_:1})]),a(l(se),{class:"[&_td]:py-3.5 [&_th]:py-3.5"},{default:t(()=>[a(l(le),null,{default:t(()=>[a(l(z),null,{default:t(()=>[a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[8]||(s[8]=[o("序号",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[9]||(s[9]=[o("创建用户",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[10]||(s[10]=[o("类型",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[11]||(s[11]=[o("平台",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[12]||(s[12]=[o("提示词名称",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[13]||(s[13]=[o("文本内容",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[14]||(s[14]=[o("账号数量",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[15]||(s[15]=[o("成功数量",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[16]||(s[16]=[o("失败数量",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[17]||(s[17]=[o("提示词ID",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[18]||(s[18]=[o("创建时间",-1)])]),_:1})]),_:1})]),_:1}),a(l(re),null,{default:t(()=>[u.taskDetail?(c(),y(l(z),{key:0},{default:t(()=>[a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[...s[19]||(s[19]=[o("1",-1)])]),_:1}),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(u.taskDetail.owner_name||"--"),1)]),_:1}),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[e("span",{class:te(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",u.taskDetail.type==="post"?"bg-blue-50 text-blue-600 ring-blue-200 dark:bg-blue-500/10 dark:text-blue-400 dark:ring-blue-500/30":u.taskDetail.type==="reply_comment"?"bg-purple-50 text-purple-600 ring-purple-200 dark:bg-purple-500/10 dark:text-purple-400 dark:ring-purple-500/30":"bg-orange-50 text-orange-600 ring-orange-200 dark:bg-orange-500/10 dark:text-orange-400 dark:ring-orange-500/30"])},i(u.taskDetail.type==="post"?"发帖":u.taskDetail.type==="reply_comment"?"回复评论":u.taskDetail.type==="reply_mention"?"回复消息":u.taskDetail.type),3)]),_:1}),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(u.taskDetail.provider||"--"),1)]),_:1}),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(u.taskDetail.prompt_name||"--"),1)]),_:1}),a(l(p),{class:"max-w-[200px] truncate",title:u.taskDetail.text},{default:t(()=>[o(i(u.taskDetail.text||"--"),1)]),_:1},8,["title"]),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(u.taskDetail.account_count||0),1)]),_:1}),a(l(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",qe,i(u.taskDetail.success_count||0),1)]),_:1}),a(l(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",Ge,i(u.taskDetail.fail_count||0),1)]),_:1}),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(u.taskDetail.prompt_id||"--"),1)]),_:1}),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(l(q)(u.taskDetail.created_at)),1)]),_:1})]),_:1})):(c(),y(l(z),{key:1},{default:t(()=>[a(l(p),{colspan:11,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...s[20]||(s[20]=[o(" 暂无数据 ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1}),a(ae,null,{default:t(()=>[e("div",Qe,[s[24]||(s[24]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"执行日志",-1)),e("div",We,[e("div",Ye,[e("div",Ze,[e("div",et,[s[22]||(s[22]=e("label",{class:"text-sm text-gray-600 dark:text-gray-400 whitespace-nowrap"},"发布状态",-1)),A(e("select",{"onUpdate:modelValue":s[1]||(s[1]=d=>$.value=d),onChange:B,class:"w-48 h-10 px-3 rounded-lg border border-gray-300 bg-white text-sm text-gray-800 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-blue-400 dark:focus:ring-blue-400"},[...s[21]||(s[21]=[e("option",{value:""},"请选择发布状态",-1),e("option",{value:"all"},"全部",-1),e("option",{value:"success"},"成功",-1),e("option",{value:"failed"},"失败",-1)])],544),[[X,$.value]])])]),e("div",tt,[e("div",at,[e("span",st," 成功: "+i(S.value.success),1),e("span",lt," 失败: "+i(S.value.failed),1)]),a(C,{size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",onClick:P,disabled:S.value.failed===0},{default:t(()=>[...s[23]||(s[23]=[o(" 重新执行失败 ",-1)])]),_:1},8,["disabled"])])])])]),a(l(se),{class:"[&_td]:py-3.5 [&_th]:py-3.5"},{default:t(()=>[a(l(le),null,{default:t(()=>[a(l(z),null,{default:t(()=>[a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[25]||(s[25]=[o("ID",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[26]||(s[26]=[o("账号ID",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[27]||(s[27]=[o("发布时间",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[28]||(s[28]=[o("状态",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[29]||(s[29]=[o("外部ID",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...s[30]||(s[30]=[o("错误信息",-1)])]),_:1})]),_:1})]),_:1}),a(l(re),null,{default:t(()=>[L.value?(c(),y(l(z),{key:0},{default:t(()=>[a(l(p),{colspan:6,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...s[31]||(s[31]=[e("div",{class:"flex items-center justify-center gap-2"},[e("svg",{class:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),o(" 加载中... ")],-1)])]),_:1})]),_:1})):w.value.length?(c(!0),b(R,{key:1},K(w.value,d=>(c(),y(l(z),{key:d.id},{default:t(()=>[a(l(p),{class:"whitespace-nowrap font-mono text-sm"},{default:t(()=>[o(i(d.id),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap font-mono text-sm"},{default:t(()=>[o(i(d.account||"--"),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(l(q)(d.publish_time)),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[e("span",{class:te(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",d.status==="success"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"])},i(d.status==="success"?"成功":d.status==="failed"?"失败":d.status),3)]),_:2},1024),a(l(p),{class:"whitespace-nowrap font-mono text-sm max-w-[120px] truncate",title:d.external_id},{default:t(()=>[o(i(d.external_id||"--"),1)]),_:2},1032,["title"]),a(l(p),{class:"max-w-[200px] truncate text-red-600 dark:text-red-400",title:d.error_message},{default:t(()=>[o(i(d.error_message||"--"),1)]),_:2},1032,["title"])]),_:2},1024))),128)):(c(),y(l(z),{key:2},{default:t(()=>[a(l(p),{colspan:6,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...s[32]||(s[32]=[o(" 暂无执行日志 ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1}),e("div",rt,[a(l(we),{page:x.value,"onUpdate:page":s[2]||(s[2]=d=>x.value=d),total:V.value,"items-per-page":I.value,"sibling-count":1,"show-edges":""},{default:t(()=>[a(l(ke),null,{default:t(({items:d})=>[a(l(be)),(c(!0),b(R,null,K(d,(h,j)=>(c(),b(R,{key:j},[h.type==="page"?(c(),y(l(he),{key:0,value:h.value,"is-active":h.value===x.value},{default:t(()=>[o(i(h.value),1)]),_:2},1032,["value","is-active"])):(c(),y(l(Ce),{key:1,index:j},null,8,["index"]))],64))),128)),a(l(_e))]),_:1})]),_:1},8,["page","total","items-per-page"])])]),_:1}),_.value?(c(),y(oe,{key:0,onClose:s[5]||(s[5]=d=>_.value=!1)},{body:t(()=>[e("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:s[3]||(s[3]=d=>_.value=!1)}),e("div",ot,[e("div",nt,[e("div",it,[s[35]||(s[35]=e("h3",{class:"text-lg font-semibold text-blue-600 dark:text-blue-400 mb-2"}," 确认重试失败任务? ",-1)),s[36]||(s[36]=e("p",{class:"text-gray-600 dark:text-gray-400 text-sm mb-6"}," 一键重新发送所有执行失败的机器人任务 (此操作仅能进行一次) ",-1)),e("div",dt,[a(C,{onClick:U,class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg text-sm font-medium"},{default:t(()=>[...s[33]||(s[33]=[o(" 确认重试 ",-1)])]),_:1}),a(C,{onClick:s[4]||(s[4]=d=>_.value=!1),variant:"outline",class:"border-blue-600 text-blue-600 hover:bg-blue-50 px-6 py-2 rounded-lg text-sm font-medium"},{default:t(()=>[...s[34]||(s[34]=[o(" 不重试 ",-1)])]),_:1})])])])])]),_:1})):ee("",!0)]))}}),pt=$e(ut,[["__scopeId","data-v-ff9245f3"]]),ft=O=>Oe(`/tasks/logs/${O}/`),ct={key:0,class:"space-y-5 sm:space-y-6"},gt={key:1,class:"space-y-5 sm:space-y-6"},vt={class:"mb-4"},mt={class:"relative"},xt={class:"mb-4 flex items-center gap-3 flex-wrap"},yt=["value"],wt={class:"flex items-center gap-2"},kt={class:"flex items-center gap-2"},bt={key:0,class:"mr-2"},_t={key:1},ht={class:"inline-flex items-center text-emerald-600 dark:text-emerald-400 font-medium"},Ct={class:"inline-flex items-center text-red-600 dark:text-red-400 font-medium"},$t={class:"flex items-center justify-end gap-2"},Dt={class:"mt-4"},zt={class:"relative z-10 w-full max-w-3xl rounded-xl bg-white p-6 shadow-lg dark:bg-gray-900"},Vt={class:"space-y-4"},St={class:"grid grid-cols-2 gap-4"},jt={class:"text-sm text-gray-900 dark:text-white"},Mt={class:"text-sm text-gray-900 dark:text-white"},Lt={class:"grid grid-cols-2 gap-4"},Bt={class:"text-sm text-gray-900 dark:text-white"},Pt={class:"text-sm text-gray-900 dark:text-white"},Rt={class:"text-sm text-gray-900 dark:text-white p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},Ft={class:"grid grid-cols-2 gap-4"},Tt={class:"text-sm text-gray-900 dark:text-white"},It={class:"text-sm text-emerald-600 dark:text-emerald-400 font-medium"},Ut={class:"flex justify-end gap-3 pt-6 mt-6 border-t border-gray-200 dark:border-gray-700"},Et={class:"relative bg-white rounded-lg shadow-xl p-6 max-w-4xl mx-auto dark:bg-gray-900"},Nt={class:"mb-6"},Ht={class:"mb-4 p-3 bg-gray-50 rounded-lg dark:bg-gray-800"},At={class:"text-sm text-gray-600 dark:text-gray-400"},Kt={class:"font-semibold text-gray-900 dark:text-white"},Ot={class:"flex justify-end gap-3"},Jt=xe({__name:"taskLog",setup(O){const T=f("任务日志"),$=f([]),x=f(1),I=f(20),V=f(0),_=f(0),L=f(!1),w=f([]),S=f(""),B=f(""),P=f(""),D=f(""),U=f(!1),u=f(!1),s=f({start:void 0,end:void 0}),d=Y(()=>{if(!s.value.start||!s.value.end)return"";const v=j(s.value.start),r=j(s.value.end);return`${v} 至 ${r}`}),h=Y(()=>s.value.start&&s.value.end),j=v=>{if(!v)return"";const r=v.year,n=String(v.month).padStart(2,"0"),m=String(v.day).padStart(2,"0");return`${r}-${n}-${m}`},M=f(!1),G=f(!1),k=f(null),ne=f(!1),J=f(!1),Q=f(null),De=f({top:0,left:0,width:0,height:0});function ze(v){k.value=v,G.value=!0}function ie(){M.value=!1,k.value=null}function Ve(){G.value=!1,k.value=null}async function Se(){if(Q.value){J.value=!0;try{await ft(Q.value.id.toString()),F.success("删除成功"),await N(),de()}catch(v){console.error("删除失败:",v);const r=v instanceof Error?v.message:"删除任务日志时发生错误";F.error("删除失败",{description:r})}finally{J.value=!1}}}function de(){ne.value=!1,Q.value=null,J.value=!1}const E=async()=>{U.value=!0,x.value=1;try{await N()}finally{U.value=!1}},je=()=>{S.value="",B.value="",P.value="",D.value="",s.value={start:void 0,end:void 0},x.value=1,N()},Me=()=>{x.value=1,N()},Le=()=>{u.value=!0},W=()=>{u.value=!1},Be=()=>{h.value&&(u.value=!1,E())},Pe=async()=>{try{const v=await He({});console.log(v.results,"res"),v&&v.results?w.value=v.results:w.value=[],console.log(w.value,"promptConfigs.value")}catch(v){console.error("获取提示词配置失败:",v),w.value=[]}},N=async()=>{var v,r;L.value=!0;try{const n={currentPage:x.value,pageSize:I.value};S.value&&(n.search=S.value),B.value&&(n.type=B.value),P.value&&(n.provider=P.value),D.value&&(n.prompt__id=parseInt(D.value)),s.value.start&&s.value.end&&(n.start_date=j(s.value.start),n.end_date=j(s.value.end));const m=await Ae(n);m&&m.results?($.value=m.results||[],V.value=((v=m.pagination)==null?void 0:v.total)||0,_.value=((r=m.pagination)==null?void 0:r.total_pages)||0):($.value=[],V.value=0,_.value=0)}catch(n){console.error("获取任务日志失败:",n);const m=n instanceof Error?n.message:"获取任务日志时发生错误";F.error("获取列表失败",{description:m}),$.value=[],V.value=0,_.value=0}finally{L.value=!1}};return Z(x,()=>{N()}),ye(()=>{Pe(),N()}),(v,r)=>(c(),y(Te,null,{default:t(()=>[a(Ie,{pageTitle:T.value},null,8,["pageTitle"]),G.value?(c(),b("div",ct,[a(pt,{taskDetail:k.value,onClose:Ve},null,8,["taskDetail"])])):(c(),b("div",gt,[a(ae,null,{default:t(()=>[e("div",vt,[e("div",mt,[A(e("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>S.value=n),type:"text",placeholder:"请输入文本内容",class:"w-64 h-10 px-4 pl-10 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800",onKeyup:Fe(E,["enter"])},null,544),[[Re,S.value]]),r[6]||(r[6]=e("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),e("div",xt,[A(e("select",{"onUpdate:modelValue":r[1]||(r[1]=n=>B.value=n),onChange:E,class:"w-48 h-10 px-4 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...r[7]||(r[7]=[e("option",{value:""},"请选择类型",-1),e("option",{value:"post"},"发帖",-1),e("option",{value:"reply_comment"},"回复评论",-1),e("option",{value:"reply_mention"},"回复消息",-1)])],544),[[X,B.value]]),A(e("select",{"onUpdate:modelValue":r[2]||(r[2]=n=>P.value=n),onChange:E,class:"w-48 h-10 px-4 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...r[8]||(r[8]=[e("option",{value:""},"请选择平台",-1),e("option",{value:"twitter"},"X",-1),e("option",{value:"facebook"},"Facebook",-1),e("option",{value:"instagram"},"Instagram",-1),e("option",{value:"threads"},"Threads",-1)])],544),[[X,P.value]]),A(e("select",{"onUpdate:modelValue":r[3]||(r[3]=n=>D.value=n),onChange:E,class:"w-48 h-10 px-4 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[r[9]||(r[9]=e("option",{value:""},"请选择提示词",-1)),(c(!0),b(R,null,K(w.value,n=>(c(),b("option",{key:n.id,value:n.id},i(n.name),9,yt))),128))],544),[[X,D.value]]),e("div",wt,[a(C,{variant:"outline",onClick:Le,class:"px-4 py-2 h-10 min-w-[220px] justify-start text-left"},{default:t(()=>[r[10]||(r[10]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),o(" "+i(d.value||"选择日期时间段"),1)]),_:1})]),e("div",kt,[a(C,{size:"sm",onClick:E,disabled:U.value,class:"bg-blue-600 hover:bg-blue-700"},{default:t(()=>[U.value?(c(),b("span",bt,"查询中...")):(c(),b("span",_t,"查询"))]),_:1},8,["disabled"]),a(C,{size:"sm",variant:"outline",onClick:je},{default:t(()=>[...r[11]||(r[11]=[o(" 重置 ",-1)])]),_:1}),a(C,{size:"sm",onClick:Me,variant:"outline",class:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300"},{default:t(()=>[...r[12]||(r[12]=[o(" 刷新 ",-1)])]),_:1})])]),a(l(se),{class:"[&_td]:py-3.5 [&_th]:py-3.5"},{default:t(()=>[a(l(le),null,{default:t(()=>[a(l(z),null,{default:t(()=>[a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[13]||(r[13]=[o("序号",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[14]||(r[14]=[o("创建时间",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[15]||(r[15]=[o("创建用户",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[16]||(r[16]=[o("类型",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[17]||(r[17]=[o("平台",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[18]||(r[18]=[o("文本内容",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[19]||(r[19]=[o("机器人数量",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[20]||(r[20]=[o("发送成功数",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap"},{default:t(()=>[...r[21]||(r[21]=[o("发送失败数",-1)])]),_:1}),a(l(g),{class:"whitespace-nowrap text-right sticky right-0 bg-white dark:bg-gray-900 z-10"},{default:t(()=>[...r[22]||(r[22]=[o("操作",-1)])]),_:1})]),_:1})]),_:1}),a(l(re),null,{default:t(()=>[L.value?(c(),y(l(z),{key:0},{default:t(()=>[a(l(p),{colspan:10,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...r[23]||(r[23]=[e("div",{class:"flex items-center justify-center gap-2"},[e("svg",{class:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),o(" 加载中... ")],-1)])]),_:1})]),_:1})):$.value.length?(c(!0),b(R,{key:1},K($.value,(n,m)=>(c(),y(l(z),{key:n.id},{default:t(()=>[a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i((x.value-1)*I.value+m+1),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(l(q)(n.created_at)),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(n.owner_name||"--"),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[e("span",{class:te(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",n.type==="post"?"bg-blue-50 text-blue-600 ring-blue-200 dark:bg-blue-500/10 dark:text-blue-400 dark:ring-blue-500/30":n.type==="reply_comment"?"bg-purple-50 text-purple-600 ring-purple-200 dark:bg-purple-500/10 dark:text-purple-400 dark:ring-purple-500/30":"bg-orange-50 text-orange-600 ring-orange-200 dark:bg-orange-500/10 dark:text-orange-400 dark:ring-orange-500/30"])},i(n.type==="post"?"发帖":n.type==="reply_comment"?"回复评论":n.type==="reply_mention"?"回复消息":n.type),3)]),_:2},1024),a(l(p),{class:"whitespace-nowrap"},{default:t(()=>[o(i(n.provider||"--"),1)]),_:2},1024),a(l(p),{class:"max-w-[300px] truncate",title:n.text},{default:t(()=>[o(i(n.text||"--"),1)]),_:2},1032,["title"]),a(l(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[o(i(n.account_count||0),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",ht,i(n.success_count||0),1)]),_:2},1024),a(l(p),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",Ct,i(n.fail_count||0),1)]),_:2},1024),a(l(p),{class:"text-right whitespace-nowrap sticky right-0 bg-white dark:bg-gray-900 z-10"},{default:t(()=>[e("div",$t,[a(C,{size:"sm",variant:"outline",onClick:H=>ze(n),class:"!text-blue-600 hover:!text-blue-700"},{default:t(()=>[...r[24]||(r[24]=[o(" 查看详情 ",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128)):(c(),y(l(z),{key:2},{default:t(()=>[a(l(p),{colspan:10,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...r[25]||(r[25]=[o("暂无数据",-1)])]),_:1})]),_:1}))]),_:1})]),_:1}),e("div",Dt,[a(l(we),{page:x.value,"onUpdate:page":r[4]||(r[4]=n=>x.value=n),total:V.value,"items-per-page":I.value,"sibling-count":1,"show-edges":""},{default:t(()=>[a(l(ke),null,{default:t(({items:n})=>[a(l(be)),(c(!0),b(R,null,K(n,(m,H)=>(c(),b(R,{key:H},[m.type==="page"?(c(),y(l(he),{key:0,value:m.value,"is-active":m.value===x.value},{default:t(()=>[o(i(m.value),1)]),_:2},1032,["value","is-active"])):(c(),y(l(Ce),{key:1,index:H},null,8,["index"]))],64))),128)),a(l(_e))]),_:1})]),_:1},8,["page","total","items-per-page"])])]),_:1}),M.value?(c(),y(oe,{key:0,fullScreenBackdrop:!0,onClose:ie},{body:t(()=>{var n,m,H,ue,pe,fe,ce,ge,ve,me;return[e("div",zt,[r[34]||(r[34]=e("h3",{class:"mb-6 text-lg font-semibold"},"任务日志详情",-1)),e("div",Vt,[e("div",St,[e("div",null,[r[26]||(r[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"创建时间",-1)),e("p",jt,i(l(q)((n=k.value)==null?void 0:n.created_at)),1)]),e("div",null,[r[27]||(r[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"创建用户",-1)),e("p",Mt,i(((m=k.value)==null?void 0:m.owner_name)||"--"),1)])]),e("div",Lt,[e("div",null,[r[28]||(r[28]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"类型",-1)),e("p",Bt,i(((H=k.value)==null?void 0:H.type)==="post"?"发帖":((ue=k.value)==null?void 0:ue.type)==="reply_comment"?"回复评论":((pe=k.value)==null?void 0:pe.type)==="reply_mention"?"回复消息":(fe=k.value)==null?void 0:fe.type),1)]),e("div",null,[r[29]||(r[29]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"平台",-1)),e("p",Pt,i(((ce=k.value)==null?void 0:ce.provider)||"--"),1)])]),e("div",null,[r[30]||(r[30]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"文本内容",-1)),e("p",Rt,i(((ge=k.value)==null?void 0:ge.text)||"--"),1)]),e("div",Ft,[e("div",null,[r[31]||(r[31]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"机器人数量",-1)),e("p",Tt,i(((ve=k.value)==null?void 0:ve.account_count)||0),1)]),e("div",null,[r[32]||(r[32]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"发送成功数",-1)),e("p",It,i(((me=k.value)==null?void 0:me.success_count)||0),1)])])]),e("div",Ut,[a(C,{variant:"outline",onClick:ie},{default:t(()=>[...r[33]||(r[33]=[o("关闭",-1)])]),_:1})])])]}),_:1})):ee("",!0),u.value?(c(),y(oe,{key:1,fullScreenBackdrop:!0,onClose:W},{body:t(()=>[e("div",Et,[e("div",{class:"flex items-center justify-between mb-4"},[r[36]||(r[36]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"选择日期时间段",-1)),e("button",{onClick:W,class:"text-gray-400 hover:text-gray-600 transition-colors dark:text-gray-500 dark:hover:text-gray-300"},[...r[35]||(r[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Nt,[a(l(Ke),{modelValue:s.value,"onUpdate:modelValue":r[5]||(r[5]=n=>s.value=n),locale:"zh-CN",class:"border border-gray-200 rounded-lg dark:border-gray-700"},null,8,["modelValue"])]),e("div",Ht,[e("p",At,[r[37]||(r[37]=o(" 已选择: ",-1)),e("span",Kt,i(d.value),1)])]),e("div",Ot,[a(C,{variant:"outline",class:"px-6 py-2 border-gray-300 text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800",onClick:W},{default:t(()=>[...r[38]||(r[38]=[o(" 取消 ",-1)])]),_:1}),a(C,{variant:"primary",class:"px-6 py-2 bg-orange-500 hover:bg-orange-600 text-white",onClick:Be,disabled:!h.value},{default:t(()=>[...r[39]||(r[39]=[o(" 确定 ",-1)])]),_:1},8,["disabled"])])])]),_:1})):ee("",!0),a(Ue,{isOpen:ne.value,title:"删除",description:"确定要删除这条任务日志吗？此操作不可撤销。",isLoading:J.value,triggerRect:De.value,onClose:de,onConfirm:Se},null,8,["isOpen","isLoading","triggerRect"])]))]),_:1}))}}),ea=$e(Jt,[["__scopeId","data-v-5e845523"]]);export{ea as default};
