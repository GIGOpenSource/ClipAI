import{d as xe,r as p,f as Y,w as Z,j as ye,c as _,x as a,z as w,B as ee,A as t,a as e,E as o,y as l,t as i,n as te,C as K,J as X,F,v as O,H as T,o as c,D as Re,K as Fe}from"./index-Bjv39BZs.js";import{_ as Te,a as Ie}from"./AdminLayout-CjMgrvGP.js";import{i as ae,_ as se,a as le,b as V,c as f,d as re,e as u,P as we,f as ke,g as be,h as _e,k as he,l as Ce,j as Ue}from"./DeleteConfirmDialog-B8rvhbQc.js";import{a as $,f as q,_ as oe}from"./chevron-right-BbcE3R7N.js";import{l as Ee,p as Ne,a as He,t as Ae,_ as Ke}from"./home-CggdsWgI.js";import{_ as $e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as Oe}from"./index-BSm4yeEa.js";const Je={class:"space-y-6"},Xe={class:"flex items-center justify-between mb-4"},qe={class:"inline-flex items-center text-emerald-600 dark:text-emerald-400 font-medium"},Ge={class:"inline-flex items-center text-red-600 dark:text-red-400 font-medium"},Qe={class:"mb-4"},We={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4 dark:bg-gray-800 dark:border-gray-700"},Ye={class:"flex items-center justify-between"},Ze={class:"flex items-center gap-4"},et={class:"flex items-center gap-2"},tt={class:"flex items-center gap-6"},at={class:"flex items-center gap-4"},st={class:"text-sm text-emerald-600 dark:text-emerald-400 font-medium"},lt={class:"text-sm text-red-600 dark:text-red-400 font-medium"},rt={class:"mt-4"},ot={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 dark:bg-gray-800"},nt={class:"p-6"},it={class:"text-center"},dt={class:"flex justify-center gap-3"},ut=xe({__name:"TaskDetail",props:{taskDetail:{}},emits:["close"],setup(v){const I=v,D=p(""),y=p(1),U=p(10),S=p(0),h=p(!1),B=p(!1),k=p([]),j=Y(()=>{const x=k.value.filter(d=>d.status==="success").length,s=k.value.filter(d=>d.status==="failed").length;return{success:x,failed:s}}),P=()=>{y.value=1,z()},R=()=>{console.log("重试按钮被点击"),console.log("失败数量:",j.value.failed),console.log("当前showRetryConfirm:",h.value),h.value=!0,console.log("设置后showRetryConfirm:",h.value)},z=async()=>{var x,s;B.value=!0;try{if(!((x=I.taskDetail)!=null&&x.id)){k.value=[],S.value=0;return}const d={simpletask_id:I.taskDetail.id,currentPage:y.value,pageSize:U.value};D.value&&D.value!=="all"&&(d.status=D.value);const C=await Ee(d);if(C&&C.results){const M=C.results||[];k.value=M.map(L=>({id:L.id||"",account:L.account||"",publish_time:L.created_at||"",status:L.success==="success"?"success":"failed",external_id:L.external_id||"",error_message:L.error_message||""})),S.value=((s=C.pagination)==null?void 0:s.total)||0}else k.value=[],S.value=0}catch(d){console.error("获取执行日志失败:",d),T.error("获取执行日志失败"),k.value=[],S.value=0}finally{B.value=!1}},E=async()=>{var x;try{h.value=!1;const s={simpletask_id:(x=I.taskDetail)==null?void 0:x.id};let d=await Ne(s);d.message?T.success(d.message):T.success("已开始重新执行失败的任务"),await z()}catch(s){console.error("重新执行失败:",s),T.error("重新执行失败")}};return Z(y,()=>{z()}),Z(()=>I.taskDetail,x=>{x!=null&&x.id&&z()},{deep:!0}),ye(()=>{z()}),(x,s)=>(c(),_("div",Je,[a(ae,null,{default:t(()=>[e("div",Xe,[s[7]||(s[7]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"任务参数",-1)),a($,{variant:"outline",onClick:s[0]||(s[0]=d=>x.$emit("close"))},{default:t(()=>[...s[6]||(s[6]=[o(" 返回 ",-1)])]),_:1})]),a(l(se),{class:"[&_td]:py-3.5 [&_th]:py-3.5"},{default:t(()=>[a(l(le),null,{default:t(()=>[a(l(V),null,{default:t(()=>[a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[8]||(s[8]=[o("序号",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[9]||(s[9]=[o("创建用户",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[10]||(s[10]=[o("类型",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[11]||(s[11]=[o("平台",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[12]||(s[12]=[o("提示词名称",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[13]||(s[13]=[o("文本内容",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[14]||(s[14]=[o("账号数量",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[15]||(s[15]=[o("成功数量",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[16]||(s[16]=[o("失败数量",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[17]||(s[17]=[o("提示词ID",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[18]||(s[18]=[o("创建时间",-1)])]),_:1})]),_:1})]),_:1}),a(l(re),null,{default:t(()=>[v.taskDetail?(c(),w(l(V),{key:0},{default:t(()=>[a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[...s[19]||(s[19]=[o("1",-1)])]),_:1}),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(v.taskDetail.owner_name||"--"),1)]),_:1}),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[e("span",{class:te(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",v.taskDetail.type==="post"?"bg-blue-50 text-blue-600 ring-blue-200 dark:bg-blue-500/10 dark:text-blue-400 dark:ring-blue-500/30":v.taskDetail.type==="reply_comment"?"bg-purple-50 text-purple-600 ring-purple-200 dark:bg-purple-500/10 dark:text-purple-400 dark:ring-purple-500/30":"bg-orange-50 text-orange-600 ring-orange-200 dark:bg-orange-500/10 dark:text-orange-400 dark:ring-orange-500/30"])},i(v.taskDetail.type==="post"?"发帖":v.taskDetail.type==="reply_comment"?"回复评论":v.taskDetail.type==="reply_mention"?"回复消息":v.taskDetail.type),3)]),_:1}),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(v.taskDetail.provider||"--"),1)]),_:1}),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(v.taskDetail.prompt_name||"--"),1)]),_:1}),a(l(u),{class:"max-w-[200px] truncate",title:v.taskDetail.text},{default:t(()=>[o(i(v.taskDetail.text||"--"),1)]),_:1},8,["title"]),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(v.taskDetail.account_count||0),1)]),_:1}),a(l(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",qe,i(v.taskDetail.success_count||0),1)]),_:1}),a(l(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",Ge,i(v.taskDetail.fail_count||0),1)]),_:1}),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(v.taskDetail.prompt_id||"--"),1)]),_:1}),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(l(q)(v.taskDetail.created_at)),1)]),_:1})]),_:1})):(c(),w(l(V),{key:1},{default:t(()=>[a(l(u),{colspan:11,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...s[20]||(s[20]=[o(" 暂无数据 ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1})]),_:1}),a(ae,null,{default:t(()=>[e("div",Qe,[s[24]||(s[24]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"执行日志",-1)),e("div",We,[e("div",Ye,[e("div",Ze,[e("div",et,[s[22]||(s[22]=e("label",{class:"text-sm text-gray-600 dark:text-gray-400 whitespace-nowrap"},"发布状态",-1)),K(e("select",{"onUpdate:modelValue":s[1]||(s[1]=d=>D.value=d),onChange:P,class:"w-48 h-10 px-3 rounded-lg border border-gray-300 bg-white text-sm text-gray-800 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:focus:border-blue-400 dark:focus:ring-blue-400"},[...s[21]||(s[21]=[e("option",{value:""},"请选择发布状态",-1),e("option",{value:"all"},"全部",-1),e("option",{value:"success"},"成功",-1),e("option",{value:"failed"},"失败",-1)])],544),[[X,D.value]])])]),e("div",tt,[e("div",at,[e("span",st," 成功: "+i(j.value.success),1),e("span",lt," 失败: "+i(j.value.failed),1)]),a($,{size:"sm",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",onClick:R,disabled:j.value.failed===0},{default:t(()=>[...s[23]||(s[23]=[o(" 重新执行失败 ",-1)])]),_:1},8,["disabled"])])])])]),a(l(se),{class:"[&_td]:py-3.5 [&_th]:py-3.5"},{default:t(()=>[a(l(le),null,{default:t(()=>[a(l(V),null,{default:t(()=>[a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[25]||(s[25]=[o("ID",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[26]||(s[26]=[o("账号ID",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[27]||(s[27]=[o("发布时间",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[28]||(s[28]=[o("状态",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[29]||(s[29]=[o("外部ID",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...s[30]||(s[30]=[o("错误信息",-1)])]),_:1})]),_:1})]),_:1}),a(l(re),null,{default:t(()=>[B.value?(c(),w(l(V),{key:0},{default:t(()=>[a(l(u),{colspan:6,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...s[31]||(s[31]=[e("div",{class:"flex items-center justify-center gap-2"},[e("svg",{class:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),o(" 加载中... ")],-1)])]),_:1})]),_:1})):k.value.length?(c(!0),_(F,{key:1},O(k.value,d=>(c(),w(l(V),{key:d.id},{default:t(()=>[a(l(u),{class:"whitespace-nowrap font-mono text-sm"},{default:t(()=>[o(i(d.id),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap font-mono text-sm"},{default:t(()=>[o(i(d.account||"--"),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(l(q)(d.publish_time)),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[e("span",{class:te(["inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium",d.status==="success"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"])},i(d.status==="success"?"成功":d.status==="failed"?"失败":d.status),3)]),_:2},1024),a(l(u),{class:"whitespace-nowrap font-mono text-sm max-w-[120px] truncate",title:d.external_id},{default:t(()=>[o(i(d.external_id||"--"),1)]),_:2},1032,["title"]),a(l(u),{class:"max-w-[200px] truncate text-red-600 dark:text-red-400",title:d.error_message},{default:t(()=>[o(i(d.error_message||"--"),1)]),_:2},1032,["title"])]),_:2},1024))),128)):(c(),w(l(V),{key:2},{default:t(()=>[a(l(u),{colspan:6,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...s[32]||(s[32]=[o(" 暂无执行日志 ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1}),e("div",rt,[a(l(we),{page:y.value,"onUpdate:page":s[2]||(s[2]=d=>y.value=d),total:S.value,"items-per-page":U.value,"sibling-count":1,"show-edges":""},{default:t(()=>[a(l(ke),null,{default:t(({items:d})=>[a(l(be)),(c(!0),_(F,null,O(d,(C,M)=>(c(),_(F,{key:M},[C.type==="page"?(c(),w(l(he),{key:0,value:C.value,"is-active":C.value===y.value},{default:t(()=>[o(i(C.value),1)]),_:2},1032,["value","is-active"])):(c(),w(l(Ce),{key:1,index:M},null,8,["index"]))],64))),128)),a(l(_e))]),_:1})]),_:1},8,["page","total","items-per-page"])])]),_:1}),h.value?(c(),w(oe,{key:0,onClose:s[5]||(s[5]=d=>h.value=!1)},{body:t(()=>[e("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:s[3]||(s[3]=d=>h.value=!1)}),e("div",ot,[e("div",nt,[e("div",it,[s[35]||(s[35]=e("h3",{class:"text-lg font-semibold text-blue-600 dark:text-blue-400 mb-2"}," 确认重试失败任务? ",-1)),s[36]||(s[36]=e("p",{class:"text-gray-600 dark:text-gray-400 text-sm mb-6"}," 一键重新发送所有执行失败的机器人任务 (此操作仅能进行一次) ",-1)),e("div",dt,[a($,{onClick:E,class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg text-sm font-medium"},{default:t(()=>[...s[33]||(s[33]=[o(" 确认重试 ",-1)])]),_:1}),a($,{onClick:s[4]||(s[4]=d=>h.value=!1),variant:"outline",class:"border-blue-600 text-blue-600 hover:bg-blue-50 px-6 py-2 rounded-lg text-sm font-medium"},{default:t(()=>[...s[34]||(s[34]=[o(" 不重试 ",-1)])]),_:1})])])])])]),_:1})):ee("",!0)]))}}),pt=$e(ut,[["__scopeId","data-v-ff9245f3"]]),ct=v=>Oe(`/tasks/logs/${v}/`),ft={key:0,class:"space-y-5 sm:space-y-6"},gt={key:1,class:"space-y-5 sm:space-y-6"},vt={class:"mb-4"},mt={class:"relative"},xt={class:"mb-4 flex items-center gap-3 flex-wrap"},yt=["value"],wt={class:"flex items-center gap-2"},kt={class:"flex items-center gap-2"},bt={key:0,class:"mr-2"},_t={key:1},ht={class:"inline-flex items-center text-emerald-600 dark:text-emerald-400 font-medium"},Ct={class:"inline-flex items-center text-red-600 dark:text-red-400 font-medium"},$t={class:"flex items-center justify-end gap-2"},Dt={class:"mt-4"},zt={class:"relative z-10 w-full max-w-3xl rounded-xl bg-white p-6 shadow-lg dark:bg-gray-900"},Vt={class:"space-y-4"},St={class:"grid grid-cols-2 gap-4"},jt={class:"text-sm text-gray-900 dark:text-white"},Mt={class:"text-sm text-gray-900 dark:text-white"},Lt={class:"grid grid-cols-2 gap-4"},Bt={class:"text-sm text-gray-900 dark:text-white"},Pt={class:"text-sm text-gray-900 dark:text-white"},Rt={class:"text-sm text-gray-900 dark:text-white p-3 bg-gray-50 dark:bg-gray-800 rounded-lg"},Ft={class:"grid grid-cols-2 gap-4"},Tt={class:"text-sm text-gray-900 dark:text-white"},It={class:"text-sm text-emerald-600 dark:text-emerald-400 font-medium"},Ut={class:"flex justify-end gap-3 pt-6 mt-6 border-t border-gray-200 dark:border-gray-700"},Et={class:"relative bg-white rounded-lg shadow-xl p-6 max-w-4xl mx-auto dark:bg-gray-900"},Nt={class:"mb-6"},Ht={class:"mb-4 p-3 bg-gray-50 rounded-lg dark:bg-gray-800"},At={class:"text-sm text-gray-600 dark:text-gray-400"},Kt={class:"font-semibold text-gray-900 dark:text-white"},Ot={class:"flex justify-end gap-3"},Jt=xe({__name:"taskLog",setup(v){const I=p("任务日志"),D=p([]),y=p(1),U=p(20),S=p(0),h=p(0),B=p(!1),k=p([]),j=p(""),P=p(""),R=p(""),z=p(""),E=p(!1),x=p(!1),s=p({start:void 0,end:void 0}),d=Y(()=>{if(!s.value.start||!s.value.end)return"";const g=M(s.value.start),r=M(s.value.end);return`${g} 至 ${r}`}),C=Y(()=>s.value.start&&s.value.end),M=g=>{if(!g)return"";const r=g.year,n=String(g.month).padStart(2,"0"),m=String(g.day).padStart(2,"0");return`${r}-${n}-${m}`},L=p(!1),G=p(!1),b=p(null),ne=p(!1),J=p(!1),Q=p(null),De=p({top:0,left:0,width:0,height:0});function ze(g){b.value=g,G.value=!0}function ie(){L.value=!1,b.value=null}function Ve(){G.value=!1,b.value=null}async function Se(){if(Q.value){J.value=!0;try{await ct(Q.value.id.toString()),T.success("删除成功"),await H(),de()}catch(g){console.error("删除失败:",g);const r=g instanceof Error?g.message:"删除任务日志时发生错误";T.error("删除失败",{description:r})}finally{J.value=!1}}}function de(){ne.value=!1,Q.value=null,J.value=!1}const N=async()=>{E.value=!0,y.value=1;try{await H()}finally{E.value=!1}},je=()=>{j.value="",P.value="",R.value="",z.value="",s.value={start:void 0,end:void 0},y.value=1,H()},Me=()=>{y.value=1,H()},Le=()=>{x.value=!0},W=()=>{x.value=!1},Be=()=>{C.value&&(x.value=!1,N())},Pe=async()=>{try{const g=await He({});console.log(g.results,"res"),g&&g.results?k.value=g.results:k.value=[],console.log(k.value,"promptConfigs.value")}catch(g){console.error("获取提示词配置失败:",g),k.value=[]}},H=async()=>{var g,r;B.value=!0;try{const n={currentPage:y.value,pageSize:U.value};j.value&&(n.search=j.value),P.value&&(n.type=P.value),R.value&&(n.provider=R.value),z.value&&(n.prompt__id=parseInt(z.value)),s.value.start&&s.value.end&&(n.start_date=M(s.value.start),n.end_date=M(s.value.end));const m=await Ae(n);m&&m.results?(D.value=m.results||[],S.value=((g=m.pagination)==null?void 0:g.total)||0,h.value=((r=m.pagination)==null?void 0:r.total_pages)||0):(D.value=[],S.value=0,h.value=0)}catch(n){console.error("获取任务日志失败:",n);const m=n instanceof Error?n.message:"获取任务日志时发生错误";T.error("获取列表失败",{description:m}),D.value=[],S.value=0,h.value=0}finally{B.value=!1}};return Z(y,()=>{H()}),ye(()=>{Pe(),H()}),(g,r)=>(c(),w(Te,null,{default:t(()=>[a(Ie,{pageTitle:I.value},null,8,["pageTitle"]),G.value?(c(),_("div",ft,[a(pt,{taskDetail:b.value,onClose:Ve},null,8,["taskDetail"])])):(c(),_("div",gt,[a(ae,null,{default:t(()=>[e("div",vt,[e("div",mt,[K(e("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>j.value=n),type:"text",placeholder:"请输入文本内容",class:"w-64 h-10 px-4 pl-10 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800",onKeyup:Fe(N,["enter"])},null,544),[[Re,j.value]]),r[6]||(r[6]=e("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])]),e("div",xt,[K(e("select",{"onUpdate:modelValue":r[1]||(r[1]=n=>P.value=n),onChange:N,class:"w-48 h-10 px-4 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...r[7]||(r[7]=[e("option",{value:""},"请选择类型",-1),e("option",{value:"post"},"发帖",-1),e("option",{value:"reply_comment"},"回复评论",-1),e("option",{value:"reply_mention"},"回复消息",-1)])],544),[[X,P.value]]),K(e("select",{"onUpdate:modelValue":r[2]||(r[2]=n=>R.value=n),onChange:N,class:"w-48 h-10 px-4 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[...r[8]||(r[8]=[e("option",{value:""},"请选择平台",-1),e("option",{value:"twitter"},"X",-1),e("option",{value:"facebook"},"Facebook",-1),e("option",{value:"instagram"},"Instagram",-1),e("option",{value:"threads"},"Threads",-1)])],544),[[X,R.value]]),K(e("select",{"onUpdate:modelValue":r[3]||(r[3]=n=>z.value=n),onChange:N,class:"w-48 h-10 px-4 rounded-lg border border-gray-300 bg-transparent text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800"},[r[9]||(r[9]=e("option",{value:""},"请选择提示词",-1)),(c(!0),_(F,null,O(k.value,n=>(c(),_("option",{key:n.id,value:n.id},i(n.name),9,yt))),128))],544),[[X,z.value]]),e("div",wt,[a($,{variant:"outline",onClick:Le,class:"px-4 py-2 h-10 min-w-[220px] justify-start text-left"},{default:t(()=>[r[10]||(r[10]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),o(" "+i(d.value||"选择日期时间段"),1)]),_:1})]),e("div",kt,[a($,{size:"sm",onClick:N,disabled:E.value,class:"bg-blue-600 hover:bg-blue-700"},{default:t(()=>[E.value?(c(),_("span",bt,"查询中...")):(c(),_("span",_t,"查询"))]),_:1},8,["disabled"]),a($,{size:"sm",variant:"outline",onClick:je},{default:t(()=>[...r[11]||(r[11]=[o(" 重置 ",-1)])]),_:1}),a($,{size:"sm",onClick:Me,variant:"outline",class:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300"},{default:t(()=>[...r[12]||(r[12]=[o(" 刷新 ",-1)])]),_:1})])]),a(l(se),{class:"[&_td]:py-3.5 [&_th]:py-3.5"},{default:t(()=>[a(l(le),null,{default:t(()=>[a(l(V),null,{default:t(()=>[a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[13]||(r[13]=[o("序号",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[14]||(r[14]=[o("创建时间",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[15]||(r[15]=[o("创建用户",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[16]||(r[16]=[o("类型",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[17]||(r[17]=[o("平台",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[18]||(r[18]=[o("文本内容",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[19]||(r[19]=[o("机器人数量",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[20]||(r[20]=[o("发送成功数",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap"},{default:t(()=>[...r[21]||(r[21]=[o("发送失败数",-1)])]),_:1}),a(l(f),{class:"whitespace-nowrap text-right sticky right-0 bg-white dark:bg-gray-900 z-10"},{default:t(()=>[...r[22]||(r[22]=[o("操作",-1)])]),_:1})]),_:1})]),_:1}),a(l(re),null,{default:t(()=>[B.value?(c(),w(l(V),{key:0},{default:t(()=>[a(l(u),{colspan:10,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...r[23]||(r[23]=[e("div",{class:"flex items-center justify-center gap-2"},[e("svg",{class:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),o(" 加载中... ")],-1)])]),_:1})]),_:1})):D.value.length?(c(!0),_(F,{key:1},O(D.value,(n,m)=>(c(),w(l(V),{key:n.id},{default:t(()=>[a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i((y.value-1)*U.value+m+1),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(l(q)(n.created_at)),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(n.owner_name||"--"),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[e("span",{class:te(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",n.type==="post"?"bg-blue-50 text-blue-600 ring-blue-200 dark:bg-blue-500/10 dark:text-blue-400 dark:ring-blue-500/30":n.type==="reply_comment"?"bg-purple-50 text-purple-600 ring-purple-200 dark:bg-purple-500/10 dark:text-purple-400 dark:ring-purple-500/30":"bg-orange-50 text-orange-600 ring-orange-200 dark:bg-orange-500/10 dark:text-orange-400 dark:ring-orange-500/30"])},i(n.type==="post"?"发帖":n.type==="reply_comment"?"回复评论":n.type==="reply_mention"?"回复消息":n.type),3)]),_:2},1024),a(l(u),{class:"whitespace-nowrap"},{default:t(()=>[o(i(n.provider||"--"),1)]),_:2},1024),a(l(u),{class:"max-w-[300px] truncate",title:n.text},{default:t(()=>[o(i(n.text||"--"),1)]),_:2},1032,["title"]),a(l(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[o(i(n.account_count||0),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",ht,i(n.success_count||0),1)]),_:2},1024),a(l(u),{class:"whitespace-nowrap text-center"},{default:t(()=>[e("span",Ct,i(n.fail_count||0),1)]),_:2},1024),a(l(u),{class:"text-right whitespace-nowrap sticky right-0 bg-white dark:bg-gray-900 z-10"},{default:t(()=>[e("div",$t,[a($,{size:"sm",variant:"outline",onClick:A=>ze(n),class:"!text-blue-600 hover:!text-blue-700"},{default:t(()=>[...r[24]||(r[24]=[o(" 查看详情 ",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128)):(c(),w(l(V),{key:2},{default:t(()=>[a(l(u),{colspan:10,class:"py-16 text-center text-gray-400 dark:text-white/40"},{default:t(()=>[...r[25]||(r[25]=[o("暂无数据",-1)])]),_:1})]),_:1}))]),_:1})]),_:1}),e("div",Dt,[a(l(we),{page:y.value,"onUpdate:page":r[4]||(r[4]=n=>y.value=n),total:S.value,"items-per-page":U.value,"sibling-count":1,"show-edges":""},{default:t(()=>[a(l(ke),null,{default:t(({items:n})=>[a(l(be)),(c(!0),_(F,null,O(n,(m,A)=>(c(),_(F,{key:A},[m.type==="page"?(c(),w(l(he),{key:0,value:m.value,"is-active":m.value===y.value},{default:t(()=>[o(i(m.value),1)]),_:2},1032,["value","is-active"])):(c(),w(l(Ce),{key:1,index:A},null,8,["index"]))],64))),128)),a(l(_e))]),_:1})]),_:1},8,["page","total","items-per-page"])])]),_:1}),L.value?(c(),w(oe,{key:0,fullScreenBackdrop:!0,onClose:ie},{body:t(()=>{var n,m,A,ue,pe,ce,fe,ge,ve,me;return[e("div",zt,[r[34]||(r[34]=e("h3",{class:"mb-6 text-lg font-semibold"},"任务日志详情",-1)),e("div",Vt,[e("div",St,[e("div",null,[r[26]||(r[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"创建时间",-1)),e("p",jt,i(l(q)((n=b.value)==null?void 0:n.created_at)),1)]),e("div",null,[r[27]||(r[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"创建用户",-1)),e("p",Mt,i(((m=b.value)==null?void 0:m.owner_name)||"--"),1)])]),e("div",Lt,[e("div",null,[r[28]||(r[28]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"类型",-1)),e("p",Bt,i(((A=b.value)==null?void 0:A.type)==="post"?"发帖":((ue=b.value)==null?void 0:ue.type)==="reply_comment"?"回复评论":((pe=b.value)==null?void 0:pe.type)==="reply_mention"?"回复消息":(ce=b.value)==null?void 0:ce.type),1)]),e("div",null,[r[29]||(r[29]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"平台",-1)),e("p",Pt,i(((fe=b.value)==null?void 0:fe.provider)||"--"),1)])]),e("div",null,[r[30]||(r[30]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"文本内容",-1)),e("p",Rt,i(((ge=b.value)==null?void 0:ge.text)||"--"),1)]),e("div",Ft,[e("div",null,[r[31]||(r[31]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"机器人数量",-1)),e("p",Tt,i(((ve=b.value)==null?void 0:ve.account_count)||0),1)]),e("div",null,[r[32]||(r[32]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-400 mb-1"},"发送成功数",-1)),e("p",It,i(((me=b.value)==null?void 0:me.success_count)||0),1)])])]),e("div",Ut,[a($,{variant:"outline",onClick:ie},{default:t(()=>[...r[33]||(r[33]=[o("关闭",-1)])]),_:1})])])]}),_:1})):ee("",!0),x.value?(c(),w(oe,{key:1,fullScreenBackdrop:!0,onClose:W},{body:t(()=>[e("div",Et,[e("div",{class:"flex items-center justify-between mb-4"},[r[36]||(r[36]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"选择日期时间段",-1)),e("button",{onClick:W,class:"text-gray-400 hover:text-gray-600 transition-colors dark:text-gray-500 dark:hover:text-gray-300"},[...r[35]||(r[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Nt,[a(l(Ke),{modelValue:s.value,"onUpdate:modelValue":r[5]||(r[5]=n=>s.value=n),locale:"zh-CN",class:"border border-gray-200 rounded-lg dark:border-gray-700"},null,8,["modelValue"])]),e("div",Ht,[e("p",At,[r[37]||(r[37]=o(" 已选择: ",-1)),e("span",Kt,i(d.value),1)])]),e("div",Ot,[a($,{variant:"outline",class:"px-6 py-2 border-gray-300 text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800",onClick:W},{default:t(()=>[...r[38]||(r[38]=[o(" 取消 ",-1)])]),_:1}),a($,{variant:"primary",class:"px-6 py-2 bg-orange-500 hover:bg-orange-600 text-white",onClick:Be,disabled:!C.value},{default:t(()=>[...r[39]||(r[39]=[o(" 确定 ",-1)])]),_:1},8,["disabled"])])])]),_:1})):ee("",!0),a(Ue,{isOpen:ne.value,title:"删除",description:"确定要删除这条任务日志吗？此操作不可撤销。",isLoading:J.value,triggerRect:De.value,onClose:de,onConfirm:Se},null,8,["isOpen","isLoading","triggerRect"])]))]),_:1}))}}),ea=$e(Jt,[["__scopeId","data-v-5e845523"]]);export{ea as default};
